
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://liltojustice.github.io/TrueAdaptiveMusic/Advanced%20Topics/Modded%20Predicates%20and%20Events/">
      
      
        <link rel="prev" href="../Advanced%20Topics/">
      
      
        <link rel="next" href="../Supported%20Input%20Widget%20Types/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Modded Predicates and Events - True Adaptive Music</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#modded-predicates-and-events" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="True Adaptive Music" class="md-header__button md-logo" aria-label="True Adaptive Music" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            True Adaptive Music
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modded Predicates and Events
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/LilTOJustice/TrueAdaptiveMusic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="True Adaptive Music" class="md-nav__button md-logo" aria-label="True Adaptive Music" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    True Adaptive Music
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/LilTOJustice/TrueAdaptiveMusic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    True Adaptive Music Wiki
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../FFmpeg%20Support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FFmpeg Support
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Topics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Topics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Advanced%20Topics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Topics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Modded Predicates and Events
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Modded Predicates and Events
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-modded-predicates-and-events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Modded Predicates and Events
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Modded Predicates and Events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-modded-predicates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Modded Predicates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Modded Predicates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-the-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing the API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-the-test-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing the test Function
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-modded-events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Modded Events
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Modded Events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-the-api_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing the API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-mixin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating the Mixin
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-the-validate-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing the validate Function
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-parameters-to-your-predicate-or-event-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding Parameters to Your Predicate or Event Type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-your-predicate-or-event-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registering Your Predicate or Event Type
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-note" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Note
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Supported%20Input%20Widget%20Types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Supported Input Widget Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../TypedIdentifiers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Typed Identifiers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Music Packs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Music Packs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Music%20Packs/Events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Music%20Packs/Music%20Pack%20Structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MusicPack Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Music%20Packs/Optional%20Node%20Parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Optional Node Parameters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Music%20Packs/Predicates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Predicates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Other Stuff
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Other Stuff
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Other%20Stuff/Converting%20Audio%20Files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Converting Audio Files (Made Easy!)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Quick Start
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Quick%20Start/For%20Creators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    For Creators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Quick%20Start/For%20Everyone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    For Everyone (Start Here)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Quick%20Start/For%20Users/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    For Users
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-modded-predicates-and-events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Modded Predicates and Events
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Modded Predicates and Events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-modded-predicates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Modded Predicates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Modded Predicates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-the-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing the API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-the-test-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing the test Function
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-modded-events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Modded Events
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Modded Events">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-the-api_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing the API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-mixin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating the Mixin
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-the-validate-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing the validate Function
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-parameters-to-your-predicate-or-event-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding Parameters to Your Predicate or Event Type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registering-your-predicate-or-event-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        Registering Your Predicate or Event Type
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-note" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Note
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="modded-predicates-and-events">Modded Predicates and Events</h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an advanced topic that requires at least some programming experience in Java/Kotlin or other similar high-level languages. Modding experience (particularly in Minecraft) is also recommended. I assume here that you already know how to create a mod for Minecraft. If you are completely new and want to learn how to create a mod, follow the <a href="https://wiki.fabricmc.net/tutorial:start">fabric tutorial here</a> as well as using <a href="https://docs.fabricmc.net/develop/getting-started/setting-up-a-development-environment">this page</a> to set up your development environment. Kotlin is <strong>required</strong> to implement modded events/predicates.</p>
</div>
<p>As of version 1.2, TrueAdaptiveMusic now allows the creation of custom predicate and event types! This allows for a whole new level of Music Pack creation as predicates and events can be made that are specific to other mods. One great example is with the Cobblemon mod. This fantastic mod adds the world of Pokémon to Minecraft, and one staple of Pokémon is the battles! There's just one problem, the battles have absolutely no music. What if we could make a new predicate type that specifically is true when the user is in a battle? Then we could specify some battle music to play when it's true! Let's dive in.</p>
<h2 id="creating-modded-predicates-and-events">Creating Modded Predicates and Events</h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As of mod version 1.3, modded predicate and event types must be registered during mod initialization, or they will not show up in-game or be recognized. As an additional consequence, the getTypeName functions should no longer be implemented. See <a href="#registering-your-predicate-or-event-type">Registering Your Predicate or Event Type</a> for how to register a modded type.</p>
</div>
<p>Implementing either modded predicates or events (or both) requires creating a "bridge mod". That is, a mod that "bridges" the functionalities of two mods. If you are the creator of the mod you want to make the bridge for, you could also just follow the steps below as an integration (similar to adding ModMenu support) directly into your mod.</p>
<p>First, make a new mod (or open up your existing mod project if you are the mod owner). I personally recommend using the Minecraft Development plugin with Intellij as it makes the boilerplate steps very easy. However you do it, you'll want to make a mod for the Minecraft version you are using and for fabric.</p>
<p>Once your environment is loaded, you'll want to get the jar files for both your mod (if you are making a bridge mod) and the TrueAdaptiveMusic mod which can be found on the <a href="https://github.com/LilTOJustice/TrueAdaptiveMusic/releases">TrueAdaptiveMusic releases page</a>. Once you have the required jars, throw them into your mod project's base directory.</p>
<p>Once you've done that, your project should look something like this:
<img alt="Project directory" src="../project_directory.png" /></p>
<p>Finally you'll need to add these as dependencies in your gradle build. Open your "build.gradle.kts" file, go to the <code>dependencies</code> task and add a <code>modImplementation</code> directive for each jar like below:
<img alt="Dependencies" src="../dependencies.png" /></p>
<p>Finally make sure to download sources for gradle and you're good to go! In IntelliJ this can be done by opening the gradle window and clicking the download icon:
<img alt="Gradle sources download" src="../gradle.png" /></p>
<p>After that task finishes, you're ready to create your custom <a href="#creating-modded-predicates">predicates</a> or <a href="#creating-modded-events">events</a>! If you are creating an event, I would still recommend reading the predicate tutorial first, as events are similar but more complicated.</p>
<h3 id="creating-modded-predicates">Creating Modded Predicates</h3>
<p>Creating modded predicates is definitely the easier of the two. To start, create a new class under the client section of your mod. For the sake of convention, please name your class with "Predicate" at the end. Here we'll name it PokeBattlePredicate, since we want music to play when we are in a pokemon battle.</p>
<p><img alt="New predicate file" src="../new_predicate_file.png" /></p>
<h4 id="implementing-the-api">Implementing the API</h4>
<p>After creating the class, have it extend the MusicPredicate abstract class from the TrueAdaptiveMusic API, which you will need to import (your IDE should be able to help you with this). If the class can't be found, try restarting your IDE or downloading sources again as shown above.</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">PokeBattlePredicate</span><span class="p">:</span><span class="w"> </span><span class="n">MusicPredicate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="p">}</span>
</span></code></pre></div>
<p>Now implement the missing virtual function implementation, <code>test(MinecraftClient)</code>:
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">PokeBattlePredicate</span><span class="p">:</span><span class="w"> </span><span class="n">MusicPredicate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">client</span><span class="p">:</span><span class="w"> </span><span class="n">MinecraftClient</span><span class="p">):</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>This is the function that decides whether your predicate should evaluate as true or false at each tick of the game. Make this just return false for now.</p>
<p>Before implementing that though, first some extra housekeeping needs to be done. This next part is <strong>required</strong> or your predicate will not work.</p>
<p>Add a companion object to your class implementing the <code>MusicPredicateCompanion&lt;T&gt;</code> interface, where <code>T</code> is your predicate class. You are <strong>required</strong> to override <code>fromJson</code> or your predicate will not work.</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">companion</span><span class="w"> </span><span class="n">object</span><span class="p">:</span><span class="w"> </span><span class="n">MusicPredicateCompanion</span><span class="o">&lt;</span><span class="n">PokeBattlePredicate</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">:</span><span class="w"> </span><span class="n">JsonObject</span><span class="p">):</span><span class="w"> </span><span class="n">MusicPredicate</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">PokeBattlePredicate</span><span class="p">()</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="p">}</span>
</span></code></pre></div>
<p>For You can keep <code>fromJson</code> as is for now, but you'll want to revisit if you decide to add additional parameters to your type as described later.</p>
<p>For now, try launching the game in your dev environment. Create a new pack, click to add a new child node, and you should now see your new type in this type list!
<img alt="New Type" src="../new_type.png" /></p>
<p>Now close the game. It's time to make the predicate type actually work!</p>
<h4 id="implementing-the-test-function">Implementing the test Function</h4>
<p>This section depends entirely on what your predicate type is actually for. So for this section I'll just show you how the <code>poke_battle</code> predicate is implemented, as it is very simple. Luckily, Cobblemon supplies a publicly available singleton object <code>CobblemonClient</code> that contains state information for the client. Inside the object is a reference to the battle. This gives us a trivial solution, just check if <code>battle</code> is null. If it isn't, return true, otherwise false. This is the resulting function:</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">client</span><span class="p">:</span><span class="w"> </span><span class="n">MinecraftClient</span><span class="p">):</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">CobblemonClient</span><span class="p">.</span><span class="na">battle</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="p">}</span>
</span></code></pre></div>
<p>Not all mods will allow such a simple solution though. You may need to use a combination of mixins and accessmodifiers to properly implement. If you run into any issues, feel free to ask for help in the <code>#modding-help</code> section of the discord (requires the Modder role). If you want to add parameters to your predicate to allow for further customization of your type, head over <a href="#adding-parameters-to-your-predicate-or-event-type">here</a>.</p>
<h3 id="creating-modded-events">Creating Modded Events</h3>
<p>Modded event types are more complicated to implement than predicate types, so I would recommend reading <a href="#creating-modded-predicates">that</a> first. What makes them more complicated is that they will <strong>almost</strong> always require a mixin to implement. I say <strong>almost</strong> because if you are making event types as an integration to a mod you own rather than as a bridge, you can just invoke the event manually from your mod code. If you don't already know how to create mixins, follow <a href="https://wiki.fabricmc.net/tutorial:mixin_introduction">this wiki</a>.</p>
<h4 id="implementing-the-api_1">Implementing the API</h4>
<p>First let's create the event class itself. This is very similar to creating a new predicate type. First create a class implementing the MusicEvent abstract class from the TrueAdaptiveMusic API, following the convention of the class name staring with "On" and ending with "Event". For this example, we'll be creating an event called <code>OnPokeBattleVictoryEvent</code> which should trigger when the user wins a pokemon battle:</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">OnPokeBattleVictoryEvent</span><span class="p">:</span><span class="w"> </span><span class="n">MusicEvent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="p">}</span>
</span></code></pre></div>
<p>Additionally we'll <strong>need</strong> to add a companion implementing the <code>MusicEventCompanion&lt;T&gt;</code> interface, where T is your event class. And it is also <strong>required</strong> you override <code>fromJson</code> or your event will not work.
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">companion</span><span class="w"> </span><span class="n">object</span><span class="p">:</span><span class="w"> </span><span class="n">MusicEventCompanion</span><span class="o">&lt;</span><span class="n">OnPokeBattleVictoryEvent</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">:</span><span class="w"> </span><span class="n">JsonObject</span><span class="p">):</span><span class="w"> </span><span class="n">MusicEvent</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OnPokeBattleVictoryEvent</span><span class="p">()</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>Unlike predicates, we don't have a <code>test</code> function to implement. This is because events aren't evaluated every tick, instead they are manually triggered by a callback invocation. This callback can be accessed via <code>MusicEvent.invokeMusicEvent</code> as shown below.</p>
<h4 id="creating-the-mixin">Creating the Mixin</h4>
<p>Now we'll need to make a mixin to trigger the event. If you are the creator of the mod are making the event for, you can just invoke the callback seen below directly in your mod code.</p>
<p>This particular mixin was a bit painful to work around, but here was the result:
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nd">@Mixin</span><span class="p">(</span><span class="n">BattleMessagePane</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kd">class</span><span class="w"> </span><span class="nc">OnPokeBattleVictoryEventMixin</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="nd">@Inject</span><span class="p">(</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">        </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s">&quot;addEntry(Lcom/cobblemon/mod/common/client/gui/battle/widgets/BattleMessagePane\</span><span class="si">$</span><span class="n">BattleMessageLine</span><span class="s">;)I&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">        </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">At</span><span class="p">(</span><span class="s">&quot;HEAD&quot;</span><span class="p">)</span><span class="o">]</span><span class="p">)</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">addEntry</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span><span class="w"> </span><span class="n">BattleMessagePane</span><span class="p">.</span><span class="na">BattleMessageLine</span><span class="p">,</span><span class="w"> </span><span class="n">ci</span><span class="p">:</span><span class="w"> </span><span class="n">CallbackInfoReturnable</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">userWonString</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">battleLang</span><span class="p">(</span><span class="s">&quot;win&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">MinecraftClient</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">player</span><span class="o">?.</span><span class="na">displayName</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="p">)</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">            </span><span class="p">.</span><span class="na">string</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">line</span><span class="p">.</span><span class="na">getInternalString</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">userWonString</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">            </span><span class="n">MusicEvent</span><span class="p">.</span><span class="na">invokeMusicEvent</span><span class="p">(</span><span class="n">TAMClient</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">.</span><span class="na">getEventRegistry</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="n">OnDayStartEvent</span><span class="p">.</span><span class="na">class</span><span class="p">))</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>From what I have found, since the mixin target is a Kotlin class, it is best to write the mixin itself in Kotlin as well. This is of course against the standard practice and Java should be used for mixins whenever possible.</p>
<p>As you can see, we are calling <code>MusicEvent.invokeMusicEvent</code> and passing in the type name of our event. This informs the internal music manager to play the event's music. That's really all there is to creating a modded event, but what if you only want the event to play under the conditions based on parameters of an individual event instance? For that you'll first want to <a href="#adding-parameters-to-your-predicate-or-event-type">add some parameters to your event type</a>, and write a <code>validate</code> implementation as show below.</p>
<h4 id="implementing-the-validate-function">Implementing the validate Function</h4>
<p>If you do add parameters to the event type, you'll want to override the <code>validate</code> member function (outisde of the companion object). This function is called just before your event is invoked to add an additional layer of logic to determine whether the event should occur. The parameters that are passed into <code>validate</code> are determined at the call site of the event invocation (i.e. in the mixin). For example you might have a setup like this (<code>stringToTest</code> is an event parameter as described <a href="#adding-parameters-to-your-predicate-or-event-type">here</a>):
<div class="language-kotlin highlight"><span class="filename">OnSomethingEvent.kt</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">OnSomethingEvent</span><span class="p">(</span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">stringToTest</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">):</span><span class="w"> </span><span class="n">MusicEvent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="k">vararg</span><span class="w"> </span><span class="n">eventArgs</span><span class="p">:</span><span class="w"> </span><span class="kt">Any?</span><span class="p">):</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">someCondition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eventArgs</span><span class="o">[</span><span class="m">0</span><span class="o">]</span><span class="w"> </span><span class="k">as?</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">someString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eventArgs</span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span><span class="k">as?</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">someCondition</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">someString</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">stringToTest</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="p">}</span>
</span></code></pre></div>
The above code takes in some arguments from the event invoker and interprets them to validate whether the event instance should occur.</p>
<p>Then at the event call site:
<div class="language-kotlin highlight"><span class="filename">SomeMixin.java</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="p">...</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">MusicEvent</span><span class="p">.</span><span class="na">invokeMusicEvent</span><span class="p">(</span><span class="n">TAMClient</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">.</span><span class="na">getEventRegistry</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="n">OnDayStartEvent</span><span class="p">.</span><span class="na">class</span><span class="p">),</span><span class="w"> </span><span class="n">someCondition</span><span class="p">,</span><span class="w"> </span><span class="n">someString</span><span class="p">)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="p">...</span>
</span></code></pre></div>
We pass in the type name like usual, but then include the parameters matching the types used in the <code>validate</code> definition.</p>
<p>Now the event will only trigger if the validate function says so after the event has been invoked by the mixin.</p>
<h3 id="adding-parameters-to-your-predicate-or-event-type">Adding Parameters to Your Predicate or Event Type</h3>
<p>Just like some vanilla predicates have additional parameters for each instance to specify, modded predicates and events can have the same. For both events and predicates, you must add your parameters a very specific way. In both cases the first thing you need to do is declare your paramaters as <code>private val</code>. For example, we'll use the <code>BiomePredicate</code>:
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">BiomePredicate</span><span class="p">(</span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">biomes</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BiomeIdentifier</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="n">MusicPredicate</span><span class="p">()</span>
</span></code></pre></div>
Here we want any instance of the <code>BiomePredicate</code> to store a list of biome identifiers (<code>biomes</code>) to match with what the current biome the player is in.</p>
<p>In order for your predicate/event parameters to work, you need to fulfill two conditions for each parameter:</p>
<ol>
<li>They must be declared in the constructor parameter list.</li>
<li>They must be one of the types supported by the UI, otherwise it will be impossible to use the UI to create an instance of the type. For a list of supported types, go <a href="../Supported%20Input%20Widget%20Types/">here</a>.</li>
</ol>
<p>We also want to make sure the predicate can be serialized properly, so inside the companion, we need to override the <code>fromJson</code> member function:
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">:</span><span class="w"> </span><span class="n">JsonObject</span><span class="p">):</span><span class="w"> </span><span class="n">BiomePredicate</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">BiomePredicate</span><span class="p">(</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">JsonHelper</span><span class="p">.</span><span class="na">hasArray</span><span class="p">(</span><span class="n">json</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">))</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">            </span><span class="n">JsonHelper</span><span class="p">.</span><span class="na">getArray</span><span class="p">(</span><span class="n">json</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">).</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">BiomeIdentifier</span><span class="p">(</span><span class="n">element</span><span class="p">.</span><span class="na">asString</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">        </span><span class="k">else</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">            </span><span class="n">listOf</span><span class="p">(</span><span class="n">BiomeIdentifier</span><span class="p">(</span><span class="n">JsonHelper</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">json</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">))))</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>Now for predicates, the parameters you created can be used in your <code>test</code> function. For events, they can be used in the <code>validate</code> function.</p>
<h3 id="registering-your-predicate-or-event-type">Registering Your Predicate or Event Type</h3>
<p>Once your type is ready for use, you need to register it, or it will not be recognized in-game. To do this, you just need to call the TAMClient helper function <code>registerPredicate</code> for predicates or <code>registerEvent</code> for events. Below is an excerpt from the TrueAdaptiveMusic client initializer for the vanilla types:
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="p">...</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">TAMClient</span><span class="p">.</span><span class="na">registerPredicate</span><span class="p">(</span><span class="s">&quot;boss&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">BossPredicate</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">TAMClient</span><span class="p">.</span><span class="na">registerPredicate</span><span class="p">(</span><span class="s">&quot;combat&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">CombatPredicate</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">TAMClient</span><span class="p">.</span><span class="na">registerPredicate</span><span class="p">(</span><span class="s">&quot;day&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DayTimePredicate</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="p">...</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="n">TAMClient</span><span class="p">.</span><span class="na">registerEvent</span><span class="p">(</span><span class="s">&quot;on_advancement_get&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">OnAdvancementGetEvent</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="n">TAMClient</span><span class="p">.</span><span class="na">registerEvent</span><span class="p">(</span><span class="s">&quot;on_boss_defeat&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">OnBossDefeatEvent</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="n">TAMClient</span><span class="p">.</span><span class="na">registerEvent</span><span class="p">(</span><span class="s">&quot;on_day_start&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">OnDayStartEvent</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="p">...</span>
</span></code></pre></div>
The first argument will determine the name of your predicate as it is serialized in the music pack rules and should conform to the <em>snake_case</em> standard, as well as the <em>on_</em> prefix for event types. The second argument is the runtime object representing the class, which can be retrieved with ::class in kotlin or .class in java.</p>
<h2 id="additional-note">Additional Note</h2>
<p>If a music pack contains events/predicates that the client doesn't have the bridge mod for, the pack will still load but those triggers will never occur.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": {"json": [".s2"]}, "base": "../..", "features": ["content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>